<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayesian estimation of a Structural Vector Autoregression with traditional and narrative sign restrictions via Gibbs sampler — estimate.BSVARSIGN • bsvarSIGNs</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian estimation of a Structural Vector Autoregression with traditional and narrative sign restrictions via Gibbs sampler — estimate.BSVARSIGN"><meta name="description" content="Estimates Bayesian Structural Vector Autoregression model
using the Gibbs sampler proposed by Waggoner &amp;amp; Zha (2003) with traditional sign restrictions
following Rubio-Ramírez, Waggoner &amp;amp; Zha (2010) and narrative sign restrictions
following Antolín-Díaz &amp;amp; Rubio-Ramírez (2018). Additionally, the parameter matrices \(A\) and \(B\)
follow a Minnesota prior and generalised-normal prior distributions respectively with the matrix-specific
overall shrinkage parameters estimated using a hierarchical prior distribution.
Given sign restrictions, in each Gibbs sampler iteration, the sampler draws rotation matrix
\(Q\) uniformly from the space of NxN orthogonal matrices and checks if the sign restrictions
are satisfied. If a valid \(Q\) is found within max_tries (defined in specify_bsvarSIGN),
the sampler saves the current \(A\) and \(B\) draw and proceeds to the next iteration.
Otherwise, the sampler then proceeds to next iteration without saving the current \(A\) and \(B\) draw.
If a narrative sign restriction is given, the posterior
draws are resampled with algorithm 1 in Antolín-Díaz &amp;amp; Rubio-Ramírez (2018).
See section Details for the model equations."><meta property="og:description" content="Estimates Bayesian Structural Vector Autoregression model
using the Gibbs sampler proposed by Waggoner &amp;amp; Zha (2003) with traditional sign restrictions
following Rubio-Ramírez, Waggoner &amp;amp; Zha (2010) and narrative sign restrictions
following Antolín-Díaz &amp;amp; Rubio-Ramírez (2018). Additionally, the parameter matrices \(A\) and \(B\)
follow a Minnesota prior and generalised-normal prior distributions respectively with the matrix-specific
overall shrinkage parameters estimated using a hierarchical prior distribution.
Given sign restrictions, in each Gibbs sampler iteration, the sampler draws rotation matrix
\(Q\) uniformly from the space of NxN orthogonal matrices and checks if the sign restrictions
are satisfied. If a valid \(Q\) is found within max_tries (defined in specify_bsvarSIGN),
the sampler saves the current \(A\) and \(B\) draw and proceeds to the next iteration.
Otherwise, the sampler then proceeds to next iteration without saving the current \(A\) and \(B\) draw.
If a narrative sign restriction is given, the posterior
draws are resampled with algorithm 1 in Antolín-Díaz &amp;amp; Rubio-Ramírez (2018).
See section Details for the model equations."><meta property="og:image" content="https://bsvars.github.io/bsvarSIGNs/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bsvarSIGNs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/bsvars/bsvarSIGNs/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Bayesian estimation of a Structural Vector Autoregression with traditional and narrative sign restrictions via Gibbs sampler</h1>
      <small class="dont-index">Source: <a href="https://github.com/bsvars/bsvarSIGNs/blob/main/R/estimate.R" class="external-link"><code>R/estimate.R</code></a></small>
      <div class="d-none name"><code>estimate.BSVARSIGN.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimates Bayesian Structural Vector Autoregression model
using the Gibbs sampler proposed by Waggoner &amp; Zha (2003) with traditional sign restrictions
following Rubio-Ramírez, Waggoner &amp; Zha (2010) and narrative sign restrictions
following Antolín-Díaz &amp; Rubio-Ramírez (2018). Additionally, the parameter matrices \(A\) and \(B\)
follow a Minnesota prior and generalised-normal prior distributions respectively with the matrix-specific
overall shrinkage parameters estimated using a hierarchical prior distribution.</p>
<p>Given sign restrictions, in each Gibbs sampler iteration, the sampler draws rotation matrix
\(Q\) uniformly from the space of <code>NxN</code> orthogonal matrices and checks if the sign restrictions
are satisfied. If a valid \(Q\) is found within <code>max_tries</code> (defined in <code>specify_bsvarSIGN</code>),
the sampler saves the current \(A\) and \(B\) draw and proceeds to the next iteration.
Otherwise, the sampler then proceeds to next iteration without saving the current \(A\) and \(B\) draw.
If a narrative sign restriction is given, the posterior
draws are resampled with <code>algorithm 1</code> in Antolín-Díaz &amp; Rubio-Ramírez (2018).</p>
<p>See section <b>Details</b> for the model equations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'BSVARSIGN'</span></span>
<span><span class="fu">estimate</span><span class="op">(</span><span class="va">specification</span>, <span class="va">S</span>, thin <span class="op">=</span> <span class="fl">1</span>, show_progress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-specification">specification<a class="anchor" aria-label="anchor" href="#arg-specification"></a></dt>
<dd><p>an object of class BSVARSIGN generated using the <code>specify_bsvarSIGN$new()</code> function.</p></dd>


<dt id="arg-s">S<a class="anchor" aria-label="anchor" href="#arg-s"></a></dt>
<dd><p>a positive integer, the number of posterior draws to be generated</p></dd>


<dt id="arg-thin">thin<a class="anchor" aria-label="anchor" href="#arg-thin"></a></dt>
<dd><p>a positive integer, specifying the frequency of MCMC output thinning</p></dd>


<dt id="arg-show-progress">show_progress<a class="anchor" aria-label="anchor" href="#arg-show-progress"></a></dt>
<dd><p>a logical value, if <code>TRUE</code> the estimation progress bar is visible</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class PosteriorBSVARSIGN containing the Bayesian estimation output and containing two elements:</p>
<p><code>posterior</code> a list with a collection of <code>S</code> draws from the posterior distribution generated via Gibbs sampler containing:</p><dl><dt>A</dt>
<dd><p>an <code>NxKxS</code> array with the posterior draws for matrix \(A\)</p></dd>

 <dt>B</dt>
<dd><p>an <code>NxNxS</code> array with the posterior draws for matrix \(B\)</p></dd>

 <dt>hyper</dt>
<dd><p>a <code>5xS</code> matrix with the posterior draws for the hyper-parameters of the hierarchical prior distribution</p></dd>

 <dt>skipped</dt>
<dd><p>an integer of the total skipped iterations,
 the Gibbs sampler performs a total of S+skipped iterations,
 when the sampler does not find a valid rotation matrix <code>Q</code> within <code>max_tries</code>,
 the current iteration is skipped (i.e. the current draw of <code>A,B</code> is not saved).
 A message is shown when skipped/(skipped+S/thin) &gt; 0.05, where S/thin is the total number of draws returned.</p></dd>


</dl><p><code>last_draw</code> an object of class BSVARSIGN with the last draw of the current MCMC run as the starting value to be passed to the continuation of the MCMC estimation using <code>estimate()</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The Structural VAR model is given by the reduced form equation:
$$Y = AX + E$$
where \(Y\) is an <code>NxT</code> matrix of dependent variables, \(X\) is a <code>KxT</code> matrix of explanatory variables,
\(E\) is an <code>NxT</code> matrix of reduced form error terms, and \(A\) is an <code>NxK</code> matrix of
autoregressive slope coefficients and parameters on deterministic terms in \(X\).</p>
<p>The structural equation is given by
$$BE = U$$
where \(U\) is an <code>NxT</code> matrix of structural form error terms, and
\(B\) is an <code>NxN</code> matrix of contemporaneous relationships. More specifically,
$$B = Q'P$$
where \(Q\) is an <code>NxN</code> rotation matrix and \(P\) is an <code>NxN</code> lower triangular matrix.</p>
<p>Finally, the structural shocks, <code>U</code>, are temporally and contemporaneously independent and jointly normally distributed with zero mean and unit variances.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Sampling from the generalised-normal full conditional posterior distribution of matrix \(B\) is implemented using the Gibbs sampler by:</p>
<p>Waggoner, D.F., and Zha, T., (2003) A Gibbs sampler for structural vector autoregressions. <em>Journal of Economic Dynamics and Control</em>, <b>28</b>, 349–366, <a href="https://doi.org/10.1016/S0165-1889%2802%2900168-9" class="external-link">doi:10.1016/S0165-1889(02)00168-9</a>
.</p>
<p>Sampling from the multivariate normal full conditional posterior distribution of each of the \(A\) matrix row is implemented using the sampler by:</p>
<p>Chan, J.C.C., Koop, G, and Yu, X. (2021) Large Order-Invariant Bayesian VARs with Stochastic Volatility.</p>
<p>Narrative sign restrictions are implemented using algorithm 1 in:</p>
<p>Antolín-Díaz, J., &amp; Rubio-Ramírez, J. F. (2018). Narrative sign restrictions for SVARs.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Tomasz Woźniak <a href="mailto:wozniak.tom@pm.me">wozniak.tom@pm.me</a>, Xiaolei Wang <a href="mailto:adamwang15@gmail.com">adamwang15@gmail.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># investigate the effects of the optimism shock</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">optimism</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># specify identifying restrictions:</span></span></span>
<span class="r-in"><span><span class="co"># + no effect on productivity (zero restriction)</span></span></span>
<span class="r-in"><span><span class="co"># + positive effect on stock prices (positive sign restriction) </span></span></span>
<span class="r-in"><span><span class="va">sign_irf</span>       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">23</span><span class="op">)</span><span class="op">)</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># specify the model and set seed</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">specification</span>  <span class="op">=</span> <span class="va"><a href="specify_bsvarSIGN.html">specify_bsvarSIGN</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">optimism</span> <span class="op">*</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>                                       p        <span class="op">=</span> <span class="fl">12</span>,</span></span>
<span class="r-in"><span>                                       sign_irf <span class="op">=</span> <span class="va">sign_irf</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                       </span></span>
<span class="r-in"><span><span class="co"># estimate the model</span></span></span>
<span class="r-in"><span><span class="va">posterior</span>      <span class="op">=</span> <span class="fu">estimate</span><span class="op">(</span><span class="va">specification</span>, S <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **************************************************|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  bsvarSIGNs: Bayesian Structural VAR with sign,   |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              zero and narrative restrictions      |</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **************************************************|</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Progress of simulation for 10 independent draws</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Press Esc to interrupt the computations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **************************************************|</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Xiaolei Wang, Tomasz Woźniak.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

